# F38 — /adopt Re-run Mode: Surgical Update

## Tasks

### T01 — Add re-run detection to adopt.md template
**Status**: done
**Description**: At the start of the adopt template instructions, add a detection step: check whether `.j2/runner.py`, `.j2/config/`, and `.j2/templates/` already exist in the target project. If all three are present, switch to re-run mode (skip spec/feature generation). If any are missing, proceed with the normal first-run adopt flow. Output which mode was detected.

### T02 — Implement surgical update instructions in adopt.md re-run mode
**Status**: done
**Description**: Add re-run mode instructions to `adopt.md`: (1) Update `runner.py` by copying the current session's `.j2/runner.py` over the target's copy. (2) Rsync `templates/` and `config/` from the j2 dev repo master using `rsync -a --update` so only newer files are copied. (3) Merge new slash commands: for each `.md` file in `.claude/commands/`, copy it to the target only if it does not already exist there. (4) Leave `specs/`, `features/`, `tasks/`, `rules.md`, and `README.md` completely untouched.

### T03 — Add re-run summary output to adopt.md
**Status**: done
**Description**: After the surgical update steps, instruct Claude to output a concise summary: list which files were updated (`runner.py`, any new templates, any new commands) and confirm which user files were left untouched. End with the standard footer.

### T04 — Write test verifying adopt template contains re-run detection logic
**Status**: done
**Description**: In `tests/test_adopt.py`, add `test_adopt_template_contains_rerun_detection` that reads `.j2/templates/adopt.md` and asserts it contains keywords indicating re-run mode detection (e.g., "already exist" or "re-run" or "surgical").
